// @flow
module.exports = (dato: any, root: any) => {
  root.createDataFile('src/data/site.yml', 'yaml', dato.site.toMap());

  dato.singleInstanceItemTypes.forEach(itemType => {
    const item = dato.itemsOfType(itemType)[0];
    if (item) {
      const src = `src/data/${itemType.apiKey}.yml`;
      root.createDataFile(src, 'yaml', item.toMap());
    }
  });

  dato.collectionItemTypes.forEach(itemType => {
    root.directory(`src/${itemType.apiKey}/`, dir => {
      dato.itemsOfType(itemType).forEach(item => {
        dir.createPost(`${item.autogeneratedSlug()}.md`, 'yaml', {
          frontmatter: item.toMap()
        });
      });
    });
  });
};
